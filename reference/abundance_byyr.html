<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create tables of abundance and basal area by year. — abundance_byyr • fgeo.analyze</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create tables of abundance and basal area by year. — abundance_byyr" />
<meta property="og:description" content="

abundance_byyr() first picks the main stem of each tree (see
?fgeo.tool::pick_main_stem()). Then, for each species and each
round-mean-year of measurement, it counts the number of trees. The result
includes main stems within a given dbh range.
basal_area_byyr() first sums the basal basal area of all stems of each
tree. Then, for each species and each round-mean-year of measurement,
it sums the basal area of all trees. The result includes all stems within a
given dbh range (notice the difference with abundance_byyr()).

" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fgeo.analyze</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.12.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/siteonly/tt_test.html">Habitat-species associations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/maurolepore">
    <span class="fa fa-gavel"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/forestgeo/fgeo.analyze">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://forestgeo.github.io/fgeo/">fgeo</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create tables of abundance and basal area by year.</h1>
    <small class="dont-index">Source: <a href='https://github.com/forestgeo/fgeo.analyze/blob/master/R/byyr.R'><code>R/byyr.R</code></a></small>
    <div class="hidden name"><code>abundance_byyr.Rd</code></div>
    </div>

    <div class="ref-description">
    
<ul>
<li><p><code>abundance_byyr()</code> first picks the main stem of each tree (see
?<code><a href='https://rdrr.io/pkg/fgeo.tool/man/pick_main_stem.html'>fgeo.tool::pick_main_stem()</a></code>). Then, for each species and each
round-mean-year of measurement, it counts the number of trees. The result
includes <strong>main stems</strong> within a given dbh range.</p></li>
<li><p><code>basal_area_byyr()</code> first sums the basal basal area of all stems of each
tree. Then, for each species and each round-mean-year of measurement,
it sums the basal area of all trees. The result includes all stems within a
given dbh range (notice the difference with <code>abundance_byyr()</code>).</p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>abundance_byyr</span>(<span class='no'>vft</span>, <span class='no'>...</span>)

<span class='fu'>basal_area_byyr</span>(<span class='no'>vft</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>vft</th>
      <td><p>A ForestGEO-like dataframe; particularly a ViewFullTable. As such,
it should contain columns <code>PlotName</code>, <code>CensusID</code>, <code>TreeID</code>, <code>StemID</code>,
<code>Status</code>, <code>DBH</code>, <code>Genus</code>, <code>SpeciesName</code>, <code>ExactDate</code>, <code>PlotCensusNumber</code>,
<code>Family</code>, <code>Tag</code>, and <code>HOM</code>. <code>ExactDate</code> should contain dates from
1980-01-01 to the present day in the format yyyy-mm-dd.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Expressions to pick main stems of a specific <code>dbh</code> range (e.g.
<code>DBH &gt;= 10</code> or <code>DBH &gt;= 10, DBH &lt; 20</code>, or <code>DBH &gt;= 10 &amp; DBH &lt; 20</code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A dataframe.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>You don't need to pick stems by status before feeding data to these
functions. Doing so may make your code more readable but it should not affect
the result. This is because the expressions passed to <code>...</code> pick data by
<code>dbh</code> and exclude the missing <code>dbh</code> values associated to non-alive stems,
including dead, missing, and gone stems.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/fgeo.tool/man/pick_main_stem.html'>fgeo.tool::pick_main_stem()</a></code>.</p>
<p>Other functions for abundance and basal area: 
<code><a href='abundance.html'>abundance</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>fgeo.tool</span>)

<span class='co'># Example data</span>
<span class='no'>vft</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/fgeo.tool/man/reexports.html'>tibble</a></span>(
  <span class='kw'>PlotName</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"luq"</span>, <span class='st'>"luq"</span>, <span class='st'>"luq"</span>, <span class='st'>"luq"</span>, <span class='st'>"luq"</span>, <span class='st'>"luq"</span>, <span class='st'>"luq"</span>, <span class='st'>"luq"</span>),
  <span class='kw'>CensusID</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>),
  <span class='kw'>TreeID</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>, <span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>),
  <span class='kw'>StemID</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.1</span>, <span class='fl'>1.2</span>, <span class='fl'>2.1</span>, <span class='fl'>2.2</span>, <span class='fl'>1.1</span>, <span class='fl'>1.2</span>, <span class='fl'>2.1</span>, <span class='fl'>2.2</span>),
  <span class='kw'>Status</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(
    <span class='st'>"alive"</span>, <span class='st'>"dead"</span>, <span class='st'>"alive"</span>, <span class='st'>"alive"</span>, <span class='st'>"alive"</span>, <span class='st'>"gone"</span>,
    <span class='st'>"dead"</span>, <span class='st'>"dead"</span>
  ),
  <span class='kw'>DBH</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10L</span>, <span class='fl'>NA</span>, <span class='fl'>20L</span>, <span class='fl'>30L</span>, <span class='fl'>20L</span>, <span class='fl'>NA</span>, <span class='fl'>NA</span>, <span class='fl'>NA</span>),
  <span class='kw'>Genus</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Gn"</span>, <span class='st'>"Gn"</span>, <span class='st'>"Gn"</span>, <span class='st'>"Gn"</span>, <span class='st'>"Gn"</span>, <span class='st'>"Gn"</span>, <span class='st'>"Gn"</span>, <span class='st'>"Gn"</span>),
  <span class='kw'>SpeciesName</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"spp"</span>, <span class='st'>"spp"</span>, <span class='st'>"spp"</span>, <span class='st'>"spp"</span>, <span class='st'>"spp"</span>, <span class='st'>"spp"</span>, <span class='st'>"spp"</span>, <span class='st'>"spp"</span>),
  <span class='kw'>ExactDate</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(
    <span class='st'>"2001-01-01"</span>, <span class='st'>"2001-01-01"</span>, <span class='st'>"2001-01-01"</span>, <span class='st'>"2001-01-01"</span>,
    <span class='st'>"2002-01-01"</span>, <span class='st'>"2002-01-01"</span>, <span class='st'>"2002-01-01"</span>,
    <span class='st'>"2002-01-01"</span>
  ),
  <span class='kw'>PlotCensusNumber</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>),
  <span class='kw'>Family</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"f"</span>, <span class='st'>"f"</span>, <span class='st'>"f"</span>, <span class='st'>"f"</span>, <span class='st'>"f"</span>, <span class='st'>"f"</span>, <span class='st'>"f"</span>, <span class='st'>"f"</span>),
  <span class='kw'>Tag</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>, <span class='fl'>1L</span>, <span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>2L</span>),
  <span class='kw'>HOM</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>130L</span>, <span class='fl'>130L</span>, <span class='fl'>130L</span>, <span class='fl'>130L</span>, <span class='fl'>130L</span>, <span class='fl'>130L</span>, <span class='fl'>130L</span>, <span class='fl'>130L</span>)
)

<span class='no'>vft</span></div><div class='output co'>#&gt; # A tibble: 8 x 13
#&gt;   PlotName CensusID TreeID StemID Status   DBH Genus SpeciesName ExactDate
#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;    
#&gt; 1 luq             1      1    1.1 alive     10 Gn    spp         2001-01-…
#&gt; 2 luq             1      1    1.2 dead      NA Gn    spp         2001-01-…
#&gt; 3 luq             1      2    2.1 alive     20 Gn    spp         2001-01-…
#&gt; 4 luq             1      2    2.2 alive     30 Gn    spp         2001-01-…
#&gt; 5 luq             2      1    1.1 alive     20 Gn    spp         2002-01-…
#&gt; 6 luq             2      1    1.2 gone      NA Gn    spp         2002-01-…
#&gt; 7 luq             2      2    2.1 dead      NA Gn    spp         2002-01-…
#&gt; 8 luq             2      2    2.2 dead      NA Gn    spp         2002-01-…
#&gt; # … with 4 more variables: PlotCensusNumber &lt;int&gt;, Family &lt;chr&gt;, Tag &lt;int&gt;,
#&gt; #   HOM &lt;int&gt;</div><div class='input'>
<span class='fu'>abundance_byyr</span>(<span class='no'>vft</span>, <span class='no'>DBH</span> <span class='kw'>&gt;=</span> <span class='fl'>10</span>, <span class='no'>DBH</span> <span class='kw'>&lt;</span> <span class='fl'>20</span>)</div><div class='output co'>#&gt; # A tibble: 1 x 3
#&gt;   species family yr_2001
#&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;
#&gt; 1 Gn spp  f            1</div><div class='input'>
<span class='fu'>abundance_byyr</span>(<span class='no'>vft</span>, <span class='no'>DBH</span> <span class='kw'>&gt;=</span> <span class='fl'>10</span>)</div><div class='output co'>#&gt; # A tibble: 1 x 4
#&gt;   species family yr_2001 yr_2002
#&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 Gn spp  f            2       1</div><div class='input'>
<span class='no'>basal</span> <span class='kw'>&lt;-</span> <span class='fu'>basal_area_byyr</span>(<span class='no'>vft</span>, <span class='no'>DBH</span> <span class='kw'>&gt;=</span> <span class='fl'>10</span>)
<span class='no'>basal</span></div><div class='output co'>#&gt; # A tibble: 1 x 4
#&gt;   species family yr_2001 yr_2002
#&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 Gn spp  f        1100.    314.</div><div class='input'>
<span class='co'># Skip R CMD check for speed</span>
<span class='co'># \donttest{</span>
<span class='no'>measurements_is_installed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span>(<span class='st'>"measurements"</span>, <span class='kw'>quietly</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='kw'>if</span> (<span class='no'>measurements_is_installed</span>) {
  <span class='co'># Convert units</span>
  <span class='no'>years</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"yr_2001"</span>, <span class='st'>"yr_2002"</span>)
  <span class='no'>basal_he</span> <span class='kw'>&lt;-</span> <span class='no'>basal</span> <span class='kw'>%&gt;%</span>
    <span class='kw pkg'>purrr</span><span class='kw ns'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/modify.html'>modify_at</a></span>(
      <span class='no'>years</span>,
      ~ <span class='kw pkg'>measurements</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/measurements/man/conv_unit.html'>conv_unit</a></span>(<span class='no'>.x</span>, <span class='kw'>from</span> <span class='kw'>=</span> <span class='st'>"mm2"</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='st'>"hectare"</span>)
    )
  <span class='no'>basal_he</span>

  <span class='co'># Standardize</span>
  <span class='no'>number_of_hectares</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span>
  <span class='no'>basal_he</span> <span class='kw'>%&gt;%</span>
    <span class='kw pkg'>purrr</span><span class='kw ns'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map_if.html'>map_at</a></span>(<span class='no'>years</span>, ~ <span class='no'>.x</span> / <span class='no'>number_of_hectares</span>)
}</div><div class='output co'>#&gt; $species
#&gt; [1] "Gn spp"
#&gt; 
#&gt; $family
#&gt; [1] "f"
#&gt; 
#&gt; $yr_2001
#&gt; [1] 2.199115e-09
#&gt; 
#&gt; $yr_2002
#&gt; [1] 6.283185e-10
#&gt; </div><div class='input'># }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://github.com/maurolepore'>Mauro Lepore</a>, <a href='https://forestgeo.si.edu/arellano-gabriel'>Gabriel Arellano</a>, Richard Condit, Matteo Detto, Kyle Harms, Suzanne Lao, Sabrina Russo, Daniel Zuleta.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


